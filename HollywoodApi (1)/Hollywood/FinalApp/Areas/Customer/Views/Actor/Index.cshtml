@model FinalApp.Areas.Customer.ViewModels.ActorIndexViewModel
@{
    ViewBag.Title = "Index";
    Layout = "~/Areas/Customer/Views/Shared/_CustomerLayout.cshtml";
}

@section MyStyles{
    <style>
       .cartBtn{
           padding:8px 8px;
           background-color: #0094ff;
           font-size:14px;
           border-radius:10px;
           text-transform:uppercase;
           font-weight:bold;
           color:white;
       }
    </style>    
}

<div class="container">
    <div class="row">
        <div class="col-12" style="height:40px;">

        </div>
    </div>
    <!-- home -->
    <div class="home home--static">
        <div class="home__carousel owl-carousel" id="flixtv-hero">
            <div class="home__card">
                <a href="details.html">
                    <img src="img/home/1.jpg" alt="">
                </a>
                <div>
                    <h2>Money Plane</h2>
                    <ul>
                        <li>Free</li>
                        <li>Action</li>
                        <li>2021</li>
                    </ul>
                </div>
                <button class="home__add" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16,2H8A3,3,0,0,0,5,5V21a1,1,0,0,0,.5.87,1,1,0,0,0,1,0L12,18.69l5.5,3.18A1,1,0,0,0,18,22a1,1,0,0,0,.5-.13A1,1,0,0,0,19,21V5A3,3,0,0,0,16,2Zm1,17.27-4.5-2.6a1,1,0,0,0-1,0L7,19.27V5A1,1,0,0,1,8,4h8a1,1,0,0,1,1,1Z" /></svg></button>
                <span class="home__rating"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22,9.67A1,1,0,0,0,21.14,9l-5.69-.83L12.9,3a1,1,0,0,0-1.8,0L8.55,8.16,2.86,9a1,1,0,0,0-.81.68,1,1,0,0,0,.25,1l4.13,4-1,5.68A1,1,0,0,0,6.9,21.44L12,18.77l5.1,2.67a.93.93,0,0,0,.46.12,1,1,0,0,0,.59-.19,1,1,0,0,0,.4-1l-1-5.68,4.13-4A1,1,0,0,0,22,9.67Zm-6.15,4a1,1,0,0,0-.29.88l.72,4.2-3.76-2a1.06,1.06,0,0,0-.94,0l-3.76,2,.72-4.2a1,1,0,0,0-.29-.88l-3-3,4.21-.61a1,1,0,0,0,.76-.55L12,5.7l1.88,3.82a1,1,0,0,0,.76.55l4.21.61Z" /></svg> 9.1</span>
            </div>

            <div class="home__card">
                <a href="details.html">
                    <img src="img/home/2.jpg" alt="">
                </a>
                <div>
                    <h2>The Art of Political</h2>
                    <ul>
                        <li>Free</li>
                        <li>Documentary</li>
                        <li>2019</li>
                    </ul>
                </div>
                <button class="home__add" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16,2H8A3,3,0,0,0,5,5V21a1,1,0,0,0,.5.87,1,1,0,0,0,1,0L12,18.69l5.5,3.18A1,1,0,0,0,18,22a1,1,0,0,0,.5-.13A1,1,0,0,0,19,21V5A3,3,0,0,0,16,2Zm1,17.27-4.5-2.6a1,1,0,0,0-1,0L7,19.27V5A1,1,0,0,1,8,4h8a1,1,0,0,1,1,1Z" /></svg></button>
                <span class="home__rating"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22,9.67A1,1,0,0,0,21.14,9l-5.69-.83L12.9,3a1,1,0,0,0-1.8,0L8.55,8.16,2.86,9a1,1,0,0,0-.81.68,1,1,0,0,0,.25,1l4.13,4-1,5.68A1,1,0,0,0,6.9,21.44L12,18.77l5.1,2.67a.93.93,0,0,0,.46.12,1,1,0,0,0,.59-.19,1,1,0,0,0,.4-1l-1-5.68,4.13-4A1,1,0,0,0,22,9.67Zm-6.15,4a1,1,0,0,0-.29.88l.72,4.2-3.76-2a1.06,1.06,0,0,0-.94,0l-3.76,2,.72-4.2a1,1,0,0,0-.29-.88l-3-3,4.21-.61a1,1,0,0,0,.76-.55L12,5.7l1.88,3.82a1,1,0,0,0,.76.55l4.21.61Z" /></svg> 8.3</span>
            </div>

            <div class="home__card">
                <a href="details.html">
                    <img src="img/home/3.jpg" alt="">
                </a>
                <div>
                    <h2>Antebellum</h2>
                    <ul>
                        <li>Free</li>
                        <li>Horror</li>
                        <li>2021</li>
                    </ul>
                </div>
                <button class="home__add" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16,2H8A3,3,0,0,0,5,5V21a1,1,0,0,0,.5.87,1,1,0,0,0,1,0L12,18.69l5.5,3.18A1,1,0,0,0,18,22a1,1,0,0,0,.5-.13A1,1,0,0,0,19,21V5A3,3,0,0,0,16,2Zm1,17.27-4.5-2.6a1,1,0,0,0-1,0L7,19.27V5A1,1,0,0,1,8,4h8a1,1,0,0,1,1,1Z" /></svg></button>
                <span class="home__rating"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22,9.67A1,1,0,0,0,21.14,9l-5.69-.83L12.9,3a1,1,0,0,0-1.8,0L8.55,8.16,2.86,9a1,1,0,0,0-.81.68,1,1,0,0,0,.25,1l4.13,4-1,5.68A1,1,0,0,0,6.9,21.44L12,18.77l5.1,2.67a.93.93,0,0,0,.46.12,1,1,0,0,0,.59-.19,1,1,0,0,0,.4-1l-1-5.68,4.13-4A1,1,0,0,0,22,9.67Zm-6.15,4a1,1,0,0,0-.29.88l.72,4.2-3.76-2a1.06,1.06,0,0,0-.94,0l-3.76,2,.72-4.2a1,1,0,0,0-.29-.88l-3-3,4.21-.61a1,1,0,0,0,.76-.55L12,5.7l1.88,3.82a1,1,0,0,0,.76.55l4.21.61Z" /></svg> 7.9</span>
            </div>

            <div class="home__card">
                <a href="details.html">
                    <img src="img/home/4.jpg" alt="">
                </a>
                <div>
                    <h2>Kids Next Door</h2>
                    <ul>
                        <li>Free</li>
                        <li>Documentary</li>
                        <li>2017</li>
                    </ul>
                </div>
                <button class="home__add" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16,2H8A3,3,0,0,0,5,5V21a1,1,0,0,0,.5.87,1,1,0,0,0,1,0L12,18.69l5.5,3.18A1,1,0,0,0,18,22a1,1,0,0,0,.5-.13A1,1,0,0,0,19,21V5A3,3,0,0,0,16,2Zm1,17.27-4.5-2.6a1,1,0,0,0-1,0L7,19.27V5A1,1,0,0,1,8,4h8a1,1,0,0,1,1,1Z" /></svg></button>
                <span class="home__rating"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22,9.67A1,1,0,0,0,21.14,9l-5.69-.83L12.9,3a1,1,0,0,0-1.8,0L8.55,8.16,2.86,9a1,1,0,0,0-.81.68,1,1,0,0,0,.25,1l4.13,4-1,5.68A1,1,0,0,0,6.9,21.44L12,18.77l5.1,2.67a.93.93,0,0,0,.46.12,1,1,0,0,0,.59-.19,1,1,0,0,0,.4-1l-1-5.68,4.13-4A1,1,0,0,0,22,9.67Zm-6.15,4a1,1,0,0,0-.29.88l.72,4.2-3.76-2a1.06,1.06,0,0,0-.94,0l-3.76,2,.72-4.2a1,1,0,0,0-.29-.88l-3-3,4.21-.61a1,1,0,0,0,.76-.55L12,5.7l1.88,3.82a1,1,0,0,0,.76.55l4.21.61Z" /></svg> 8.4</span>
            </div>

            <div class="home__card">
                <a href="details.html">
                    <img src="img/home/5.jpg" alt="">
                </a>
                <div>
                    <h2>The Empty Man</h2>
                    <ul>
                        <li>Free</li>
                        <li>Horror</li>
                        <li>2020</li>
                    </ul>
                </div>
                <button class="home__add" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16,2H8A3,3,0,0,0,5,5V21a1,1,0,0,0,.5.87,1,1,0,0,0,1,0L12,18.69l5.5,3.18A1,1,0,0,0,18,22a1,1,0,0,0,.5-.13A1,1,0,0,0,19,21V5A3,3,0,0,0,16,2Zm1,17.27-4.5-2.6a1,1,0,0,0-1,0L7,19.27V5A1,1,0,0,1,8,4h8a1,1,0,0,1,1,1Z" /></svg></button>
                <span class="home__rating"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22,9.67A1,1,0,0,0,21.14,9l-5.69-.83L12.9,3a1,1,0,0,0-1.8,0L8.55,8.16,2.86,9a1,1,0,0,0-.81.68,1,1,0,0,0,.25,1l4.13,4-1,5.68A1,1,0,0,0,6.9,21.44L12,18.77l5.1,2.67a.93.93,0,0,0,.46.12,1,1,0,0,0,.59-.19,1,1,0,0,0,.4-1l-1-5.68,4.13-4A1,1,0,0,0,22,9.67Zm-6.15,4a1,1,0,0,0-.29.88l.72,4.2-3.76-2a1.06,1.06,0,0,0-.94,0l-3.76,2,.72-4.2a1,1,0,0,0-.29-.88l-3-3,4.21-.61a1,1,0,0,0,.76-.55L12,5.7l1.88,3.82a1,1,0,0,0,.76.55l4.21.61Z" /></svg> 8.4</span>
            </div>

            <div class="home__card">
                <a href="details.html">
                    <img src="img/home/6.jpg" alt="">
                </a>
                <div>
                    <h2>Jungleland</h2>
                    <ul>
                        <li>Free</li>
                        <li>Documentary</li>
                        <li>2020</li>
                    </ul>
                </div>
                <button class="home__add" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16,2H8A3,3,0,0,0,5,5V21a1,1,0,0,0,.5.87,1,1,0,0,0,1,0L12,18.69l5.5,3.18A1,1,0,0,0,18,22a1,1,0,0,0,.5-.13A1,1,0,0,0,19,21V5A3,3,0,0,0,16,2Zm1,17.27-4.5-2.6a1,1,0,0,0-1,0L7,19.27V5A1,1,0,0,1,8,4h8a1,1,0,0,1,1,1Z" /></svg></button>
                <span class="home__rating"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22,9.67A1,1,0,0,0,21.14,9l-5.69-.83L12.9,3a1,1,0,0,0-1.8,0L8.55,8.16,2.86,9a1,1,0,0,0-.81.68,1,1,0,0,0,.25,1l4.13,4-1,5.68A1,1,0,0,0,6.9,21.44L12,18.77l5.1,2.67a.93.93,0,0,0,.46.12,1,1,0,0,0,.59-.19,1,1,0,0,0,.4-1l-1-5.68,4.13-4A1,1,0,0,0,22,9.67Zm-6.15,4a1,1,0,0,0-.29.88l.72,4.2-3.76-2a1.06,1.06,0,0,0-.94,0l-3.76,2,.72-4.2a1,1,0,0,0-.29-.88l-3-3,4.21-.61a1,1,0,0,0,.76-.55L12,5.7l1.88,3.82a1,1,0,0,0,.76.55l4.21.61Z" /></svg> 9.1</span>
            </div>

            <div class="home__card">
                <a href="details.html">
                    <img src="img/home/7.jpg" alt="">
                </a>
                <div>
                    <h2>Bad Impulse</h2>
                    <ul>
                        <li>Free</li>
                        <li>History</li>
                        <li>2017</li>
                    </ul>
                </div>
                <button class="home__add" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16,2H8A3,3,0,0,0,5,5V21a1,1,0,0,0,.5.87,1,1,0,0,0,1,0L12,18.69l5.5,3.18A1,1,0,0,0,18,22a1,1,0,0,0,.5-.13A1,1,0,0,0,19,21V5A3,3,0,0,0,16,2Zm1,17.27-4.5-2.6a1,1,0,0,0-1,0L7,19.27V5A1,1,0,0,1,8,4h8a1,1,0,0,1,1,1Z" /></svg></button>
                <span class="home__rating"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22,9.67A1,1,0,0,0,21.14,9l-5.69-.83L12.9,3a1,1,0,0,0-1.8,0L8.55,8.16,2.86,9a1,1,0,0,0-.81.68,1,1,0,0,0,.25,1l4.13,4-1,5.68A1,1,0,0,0,6.9,21.44L12,18.77l5.1,2.67a.93.93,0,0,0,.46.12,1,1,0,0,0,.59-.19,1,1,0,0,0,.4-1l-1-5.68,4.13-4A1,1,0,0,0,22,9.67Zm-6.15,4a1,1,0,0,0-.29.88l.72,4.2-3.76-2a1.06,1.06,0,0,0-.94,0l-3.76,2,.72-4.2a1,1,0,0,0-.29-.88l-3-3,4.21-.61a1,1,0,0,0,.76-.55L12,5.7l1.88,3.82a1,1,0,0,0,.76.55l4.21.61Z" /></svg> 8.8</span>
            </div>

            <div class="home__card">
                <a href="details.html">
                    <img src="img/home/8.jpg" alt="">
                </a>
                <div>
                    <h2>Tenet</h2>
                    <ul>
                        <li>Free</li>
                        <li>Action</li>
                        <li>2021</li>
                    </ul>
                </div>
                <button class="home__add" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16,2H8A3,3,0,0,0,5,5V21a1,1,0,0,0,.5.87,1,1,0,0,0,1,0L12,18.69l5.5,3.18A1,1,0,0,0,18,22a1,1,0,0,0,.5-.13A1,1,0,0,0,19,21V5A3,3,0,0,0,16,2Zm1,17.27-4.5-2.6a1,1,0,0,0-1,0L7,19.27V5A1,1,0,0,1,8,4h8a1,1,0,0,1,1,1Z" /></svg></button>
                <span class="home__rating"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22,9.67A1,1,0,0,0,21.14,9l-5.69-.83L12.9,3a1,1,0,0,0-1.8,0L8.55,8.16,2.86,9a1,1,0,0,0-.81.68,1,1,0,0,0,.25,1l4.13,4-1,5.68A1,1,0,0,0,6.9,21.44L12,18.77l5.1,2.67a.93.93,0,0,0,.46.12,1,1,0,0,0,.59-.19,1,1,0,0,0,.4-1l-1-5.68,4.13-4A1,1,0,0,0,22,9.67Zm-6.15,4a1,1,0,0,0-.29.88l.72,4.2-3.76-2a1.06,1.06,0,0,0-.94,0l-3.76,2,.72-4.2a1,1,0,0,0-.29-.88l-3-3,4.21-.61a1,1,0,0,0,.76-.55L12,5.7l1.88,3.82a1,1,0,0,0,.76.55l4.21.61Z" /></svg> 7.6</span>
            </div>
        </div>

        <button class="home__nav home__nav--prev" data-nav="#flixtv-hero" type="button"></button>
        <button class="home__nav home__nav--next" data-nav="#flixtv-hero" type="button"></button>
    </div>
    <!-- end home -->
    <!-- catalog -->
    <div class="catalog">
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <div class="catalog__nav">
                        <form action="/Customer/Actor/Index" class="catalog__select-wrap">
                            <div>



                                <select class="catalog__select" name="genresSearch" onchange="this.form.submit()">
                                    <option value="">All Genres</option>
                                    @foreach (var genre in Model.GenresPlayed)
                                    {
                                        <option>@genre</option>
                                    }

                                </select>

                                <select class="catalog__select" name="countriesSearch" onchange="this.form.submit()">
                                    <option value="">All Countries</option>

                                    @foreach (var country in Model.Countries)
                                    {

                                        if (country.Key == Entities.Country.United_States_of_America)
                                        {
                                            <option value="@country.Key">USA (@country.Count()) </option>
                                        }
                                        else
                                        {
                                            <option value="@country.Key">@country.Key.ToString().Replace("_", " ") (@country.Count()) </option>
                                        }

                                    }

                                </select>

                                <select class="catalog__select" name="decadesSearch" onchange="this.form.submit()">
                                    <option value="">All the years</option>
                                    @foreach (var decade in Model.Decades)
                                    {
                                        <option value="@decade.Key">@decade.Key (@decade.Count())</option>
                                    }

                                </select>




                            </div>
                            <div class="slider-radio">
                                <input onchange="this.form.submit()" type="radio" name="sortOptions" value="AlphaAsc" id="alphabetically" checked="checked"><label for="alphabetically">Alphabetically</label>
                                <input onchange="this.form.submit()" type="radio" name="sortOptions" value="AliveAsc" id="alive"><label for="alive">Alive</label>
                                <input onchange="this.form.submit()" type="radio" name="sortOptions" value="DeadAsc" id="dead"><label for="dead">Dead</label>
                                <input onchange="this.form.submit()" type="radio" name="sortOptions" value="OldestAsc" id="oldest"><label for="oldest">Oldest</label>
                                <input onchange="this.form.submit()" type="radio" name="sortOptions" value="YoungestAsc" id="youngest"><label for="youngest">Youngest</label>
                                <input onchange="this.form.submit()" type="radio" name="sortOptions" value="SalaryAsc" id="salary"><label for="salary">Salary</label>
                            </div>
                        </form>

                    </div>

                    <div class="row row--grid">
                        <div class="col" style="margin-top:20px;">
                            <div style="color: white; font-size: 12px;">Actors: @Model.Actors.Count() </div>
                            <div style="color: white; font-size: 12px; ">Average years: @Model.Actors.Average(x => x.Age).ToString("n1")</div>
                            <div style="color: white; font-size: 12px;">Average salary: @Model.Actors.Average(x => x.Salary).ToString("c0")</div>

                        </div>
                    </div>
                    <div class="row row--grid">

                        @foreach (var actor in Model.Actors)
                        {
                            <div class="col-2 col-sm-2 col-lg-2 col-xl-2">
                                <div class="card" id="@actor.ActorId">
                                    <a href="details.html" class="card__cover">
                                        <img id="@("photo"+actor.ActorId)" src="@actor.PhotoUrl" alt="">
                                    </a>
                                    <h3 id="@("fullname"+actor.ActorId)" class="card__title"><a href="details.html">@(actor.FirstName + " " + actor.LastName)</a></h3>
                                    <ul id="@("genre"+actor.ActorId)" class="card__list">
                                        @foreach (var genre in actor.Movies.Select(x => x.Genre?.Kind).ToList().Distinct())
                                        {
                                            <li>
                                                @(!String.IsNullOrEmpty(genre) ? genre : "No Genre")
                                            </li>

                                        }
                                    </ul>
                                    <ul class="card__list">
                                        <li id="@("salary"+actor.ActorId)">@actor.Salary.ToString("C0")</li>

                                    </ul>

                                    <ul class="card__list">
                                        <li id="@("borned"+actor.ActorId)">Borned: @actor.DateOfBirth.ToString("yyyy")</li>
                                        @if (actor.DateOfDeath.HasValue)
                                        {
                                            <li>Died: @actor.DateOfDeath.Value.ToString("yyyy")</li>
                                        }

                                    </ul>
                                    <ul class="card__list">

                                        <li>@actor.Age years <span style="color:red;"> @(actor.DateOfDeath.HasValue ? "Dead" : "") </span></li>      <!-- Problem!! -->

                                    </ul>
                                    <ul class="card__list">
                                        <li id="@("country"+actor.ActorId)">@actor.Country.ToString().Replace("_", " ")</li>

                                    </ul>
                                    <ul class="card__list">
                                        <li><button class="cartBtn">ADD</button></li>

                                    </ul>
                                </div>
                            </div>
                        }
                    </div>
                </div>
            </div>


        </div>
    </div>
    <!-- end catalog -->


    <div class="row">
        <div class="col-12" style="height:40px;">

        </div>
    </div>


</div>


@section MyScripts{
    
    <script>
        $(document).ready(function () {

            let actors = JSON.parse(localStorage.getItem("actorsKey"));
            if (actors) {
                for (let a of actors) {
                    let id = "#" + a.id;
                    $(id).find(".cartBtn").text("REMOVE");
                    $(id).find(".cartBtn").css("background-color", "#ff5656")
                }
            }

            



            $(".cartBtn").on("click", function () {

                let id = $(this).parent().parent().parent().attr('id');
                let photo = $("#photo" + id).attr('src');
                let fullName = $("#fullname" + id).text();
                let genre = Array.from($("#genre" + id).children()).map(x => x.innerText);
                let salary = $("#salary" + id).text();
                let borned = $("#borned" + id).text();
                let country = $("#country" + id).text();




                let actor = {
                    id,
                    photo,
                    fullName,
                    genre,
                    salary,
                    borned,
                    country
                }

                

                console.log(actor);

                if ($(this).text() == "ADD") {
                    $(this).text("REMOVE")
                    $(this).css("background-color", "#ff5656")

                    let data = localStorage.getItem("actorsKey");


                    if (!data) {
                        actors = [];
                        actors.push(actor);
                        localStorage.setItem("actorsKey", JSON.stringify(actors));
                        $("#cartNumber").text(actors.length);
                    }
                    else {
                        let actors = JSON.parse(localStorage.getItem("actorsKey"));

                        if (!(actors.some(x => x.id == actor.id))) {
                            actors.push(actor);
                            localStorage.setItem("actorsKey", JSON.stringify(actors))
                            $("#cartNumber").text(actors.length);

                        }
                    }

                    
               
                }  else {
                    $(this).text("ADD")
                    $(this).css("background-color", "#4079b7")

                    
                    let actors = JSON.parse(localStorage.getItem("actorsKey"));
                    let reducedActors = actors.filter(x => x.id != actor.id);
                    localStorage.setItem("actorsKey", JSON.stringify(reducedActors));
                    $("#cartNumber").text(reducedActors.length);

                }

               
            });

        });
    </script>    
    
    
}
